Epidemic strength and speed: rethinking metrics for infectious disease spread and control.

\vfill

SMB 2017

\vfill

Jonathan Dushoff

\url{http://lalashan.mcmaster.ca/DushoffLab}

\vfill

----------------------------------------------------------------------

EXTRA Abstract

Mathematical modeling plays a key role in forecasting epidemics, and in planning interventions. Two key measures are "big ℛ" and "little r", which I will interpret as measuring epidemic "strength" and "speed". I will discuss how these two quantities are linked by generation-interval distributions, and interpret this link using approximations and "filtered means". I will talk about measuring the strength and speed of interventions, on the same scale that we measure strength and speed of epidemics, and argue that little r is under-rated – in particular, that there are strong parallels between the interpretation of big ℛ as a measure of how difficult an epidemic is to control, and an analogous interpretation of little r.

----------------------------------------------------------------------

SEC Introduction

----------------------------------------------------------------------

Infectious diseases

FIG web_drop/flu_masks.jpg

----------------------------------------------------------------------

FIG web_drop/burial_team.jpg

----------------------------------------------------------------------

FIG Disease_data/us2000.Rout.pdf

----------------------------------------------------------------------

# The role of modeling

Models

BCC

CFIG web_drop/flat.png

NCC

	A model is a simplified view of the world

	Allows linking between assumptions and outcomes

EC

----------------------------------------------------------------------

Dynamic models

SUBH Connect scales

WIDEFIG SIR_model_family/sir.three.pdf

Small-scale events $\displaystyle \Leftrightarrow$ Large-scale patterns and outcomes

----------------------------------------------------------------------

Measles

SUBH Dynamic modeling connects scales

BCC

CFIG my_images/trans.jpg

NCC

CFIG web_drop/ew_measles.png

EC

----------------------------------------------------------------------

Ebola

SUBH Dynamic modeling connects scales

BCC

CFIG web_drop/ebola_ward.jpg

NCC

CFIG WA_Ebola_Outbreak/liberia.npc.tsplot.Rout-3.pdf

EC

----------------------------------------------------------------------

Yellow fever

SUBH Dynamic modeling connects scales

BC

CFIG web_drop/aedes.jpg

NC

CFIG my_images/endemic.Rout-0.png

EC

----------------------------------------------------------------------

TSS Speed of epidemics

BCC

	Exponential growth:

		Growth proportional to size

NCC

CFIG fitting_code/mexican_plots.Rout.pdf

EC

----------------------------------------------------------------------

Exponential growth

BCC

CFIG fitting_code/mexican_plots.Rout-0.pdf

NCC

CFIG fitting_code/mexican_plots.Rout-1.pdf

EC

----------------------------------------------------------------------

Exponential growth

BCC

CFIG fitting_code/mexican_plots.Rout-0.pdf

NCC

CFIG fitting_code/mexican_plots.Rout-5.pdf

EC

----------------------------------------------------------------------

Speed

	We measure epidemic speed using little $r$:

		The ratio of the \emph{change} in disease impact to the \emph{amount} of
		disease impact

		\emph{Units}: [1/time]

		Disease increases like $e^{rt}$

	Time scale is $C=1/r$

----------------------------------------------------------------------

Ebola outbreak

FIG my_images/weitz_full.pdf

$C \approx 1 \mathrm{month}$. Fast.

----------------------------------------------------------------------

HIV in sub-Saharan Africa

FIG SIR_simulations/hiv_plot.Rout-0.pdf

$C \approx 18 \mathrm{month}$. Horrifyingly fast.

----------------------------------------------------------------------

TSS Strength of epidemics

BC

CFIG my_images/endemic.Rout-0.png

NC

CFIG web_drop/aedes.jpg

EC

----------------------------------------------------------------------

Basic reproductive number

	We describe epidemic strength with big \Rx

	Number of potential new cases per case

	To eliminate disease, we must:

		Reduce transmission by a factor of \Rx\ \emph{or}

		Reduce number of susceptible people by a factor of \Rx\ \emph{or} \ldots

	Examples:

		Ebola, $\Rx \approx 2$

		HIV in SSA, $\Rx \approx 5$

----------------------------------------------------------------------

EXTRA Final size

ADD Content

----------------------------------------------------------------------

SEC Linking strength and speed 

----------------------------------------------------------------------

Linking little $r$ and big \Rx

FIG my_images/weitz_full.pdf

----------------------------------------------------------------------

TSS Generation intervals

BCC

	The generation distribution measures generations of the disease

		Interval between ``index'' infection and resulting infection

	What does $G$ tell us about how dangerous the epidemic is?

		It depends on what else we know!

NCC

CFIG Generation_distributions/gamHist.Rout-4.pdf

EC

----------------------------------------------------------------------

Generations and \Rx

FIG Generation_distributions/steps.Rout-1.pdf

----------------------------------------------------------------------

Generations and \Rx

FIG Generation_distributions/steps.Rout-0.pdf

----------------------------------------------------------------------

Generations and \Rx

BCC

CFIG Generation_distributions/steps.Rout-1.pdf

NCC

CFIG Generation_distributions/steps.Rout-0.pdf

EC

----------------------------------------------------------------------

Conditional effect of generation time

	\emph{Given} the reproductive number $\Rx$

		faster generation time $G$ means faster growth rate $r$

		More danger

	\emph{Given} the growth rate $r$

		faster generation time $G$ means \emph{smaller} \Rx

		Less danger

----------------------------------------------------------------------

Linking framework

	$
	\mathrm{Epidemic~speed} (r)= 
	\mathrm{Epidemic~strength} (\Rx) \times
	\mathrm{Generation~speed} (1/G)
	$

	$
	\mathrm{Epidemic~strength} (\Rx) = 
	{\mathrm{Epidemic~speed} (r) \over
	\mathrm{Generation~speed} (1/G)}
	$

		$ \Rx = r G $ (Wrong)

----------------------------------------------------------------------

SS ``Effective'' generation times

----------------------------------------------------------------------

Renewal equation

	The renewal equation is a broad framework that covers a wide range of
	possible models (including standard box models)

		$$i(t) = S(t) \int{k(\tau)i(t-\tau) \,d\tau}$$

		$i(t)$ is the \emph{rate} of new infections (per-capita incidence)

		$S(t)$ is the proportion of the population susceptible

		$k(\tau)$ measures how infectious a person is (on average) at time $\tau$
		after becoming infected

----------------------------------------------------------------------

Linearized renewal equation

	Neglect things that change infectiousness, early in an outbreak

	$$i(t) = \int{k(\tau)i(t-\tau) \,d\tau}$$

		$i$ is \emph{incidence} -- rate of new cases

		$k$ is the transmission kernel

	$$k(\tau) = \Rx g(\tau),$$ 

		\Rx\ is the effective reproductive number

		$g(\tau)$ (integrates to 1)  
		is the \emph{intrinsic} generation distribution

----------------------------------------------------------------------

Euler-Lotka equation 

	Model

		$$i(t) = \int{k(\tau)i(t-\tau) \,d\tau}$$

	Exponential phase

		Disease grows with characteristic time $C=1/r$

		$$i(t) = i(0) \exp(rt)$$

	Conclusion

		$$1 = \int{k(\tau)\exp(-r\tau) \,d\tau}$$

		$$1/\Rx = \int{g(\tau)\exp(-r\tau) \,d\tau}$$

----------------------------------------------------------------------

Interpretation: the ``effective'' generation time

	If the generation interval were absolutely fixed at a time interval
	of $G$, then 

		$${\Rx} = \exp(rG)$$

	\emph{Define} the effective generation time so that this remains
	true:

		$${\Rx} = \exp(r\hat G)$$

	Then:

		$$1/\Rx = \int{g(\tau)\exp(-r\tau) \,d\tau}$$

		$$\exp(-r\hat G) = \langle \exp(-r\tau) \rangle_g.$$

----------------------------------------------------------------------

Filtered means

	Many things we know about are examples of filtered means

		Geometric mean (log function)

		Harmonic mean (reciprocal function)

		Root mean square (square) 

----------------------------------------------------------------------

Linking framework

	$
		\mathrm{Epidemic~strength} (\Rx) = 
		{\mathrm{Epidemic~speed} (r) \over
		\mathrm{Generation~speed} (1/G)}
	$

		$ \Rx  = \exp(r\hat G) $

----------------------------------------------------------------------

$C = 1/r = 15d$

FIG Generation_distributions/lognormal.filtered.Rout-0.pdf

----------------------------------------------------------------------

$C= 1/r  = 30d$

FIG Generation_distributions/lognormal.filtered.Rout-1.pdf

----------------------------------------------------------------------

$C= 1/r  = 45d$

FIG Generation_distributions/lognormal.filtered.Rout-2.pdf

----------------------------------------------------------------------

Filtered means have intuitive properties

	Shifts in distribution shift the mean about how you would expect

		More late transmission means longer $\hat G$

	Importance of values depends on value of the filter function

	We can predict from the filter function what the effects of
	increasing variance will be

	As distribution gets narrower, $\hat G$ approaches $\bar G$

----------------------------------------------------------------------

The filtering function
		
	$\exp(-r \hat G) = \langle \exp(-r \tau) \rangle_g$,

	$\hat G$ is the mean of the generation distribution $g(\tau)$ ...

	Filtered by the discount function associated with the rate of
	exponential growth of the epidemic 

		i.e., the relative importance of a contribution at that time

----------------------------------------------------------------------

Linking framework

	$
		\mathrm{Epidemic~strength} (\Rx) = 
		{\mathrm{Epidemic~speed} (r) \over
		\mathrm{Generation~speed} (1/G)}
	$

		$ \Rx  = \exp(r\hat G) $

----------------------------------------------------------------------


Example: Post-death transmission and safe burial

BC

	How much Ebola spread occurs before vs.\ after death

	Highly context dependent

		Funeral practices, disease knowledge

	CREDIT Weitz and Dushoff \emph{Scientific Reports} 5:8751.

NC

FIG web_drop/burial_team.jpg

EC

----------------------------------------------------------------------

Standard disease model 

WIDEFIG SIR_model_family/seir.four.pdf

----------------------------------------------------------------------

Disease model including post-death transmission

WIDEFIG SIR_model_family/seird.four.pdf

----------------------------------------------------------------------

Disease model including post-death transmission

WIDEFIG SIR_model_family/brides.four.pdf

----------------------------------------------------------------------

Scenarios

FIG my_images/weitz_full.pdf

----------------------------------------------------------------------

Conclusions

	Different parameters can produce indistinguishable early dynamics

	More after-death transmission implies

		Higher \Ro

		Larger epidemics

		Larger importance of safe burials

----------------------------------------------------------------------

SS Moment approximations

----------------------------------------------------------------------

Tangled web

	The filtered mean is useful -- but complicated

		Filtering function is not scale free.

	Unless the \emph{generation interval} (not recovery time) is
	absolutely fixed, $\hat G$ will change even when $g$ does not

	How is
	
		$\Rx = \exp(r \hat G)$

	Consistent with the result from ODEs

		$\Rx = 1 + r \bar G?$

----------------------------------------------------------------------

An approximation

	We connect these quantities with a moment approximation

	Define $\kappa = {\sigma^2_G}/{\mu^2_G}$ -- the squared
	coefficient of variation of the generation distribution

	$\Rx \approx (1 + r \kappa \bar G)^{1/\kappa}$

		Equal when $G$ has a gamma distribution

		Simple and straightforward

		When is it a useful approximation?

----------------------------------------------------------------------

Compound-interest interpretation

	Define $\Rx \approx (1 + r \kappa \bar G)^{1/\kappa} \equiv X(r \bar G; 1/\kappa)$

	$X$ is the compound-interest approximation to the exponential

		Linear when $\kappa=1$ (i.e., when $g$ is exponential)

		Approaches exponential as $\kappa \to 0$

----------------------------------------------------------------------

Moment approximation

BCC

WIDEFIG Generation_distributions/gamHist.Rout-0.pdf

NCC

WIDEFIG Generation_distributions/gamHist.Rout-1.pdf

EC

----------------------------------------------------------------------

Moment approximation

BCC

WIDEFIG Generation_distributions/gamHist.Rout-2.pdf

NCC

WIDEFIG Generation_distributions/gamHist.Rout-3.pdf

EC

----------------------------------------------------------------------

Moment approximation

BCC

WIDEFIG Generation_distributions/gamHist.Rout-4.pdf

NCC

WIDEFIG Generation_distributions/gamHist.Rout-5.pdf

EC

----------------------------------------------------------------------

Moment approximation

BCC

WIDEFIG Generation_distributions/gamHist.Rout-6.pdf

NCC

WIDEFIG Generation_distributions/gamHist.Rout-7.pdf

EC

----------------------------------------------------------------------

Qualitative response

	For a given value of $\bar G$, smaller values of $\kappa$ mean:

		less variation in generation interval

		less compounding of growth

		greater \Rx\ required for a given $r$

----------------------------------------------------------------------

Fitting to Ebola

	Simulate generation intervals based on data and approach from
	WHO report

	Use both lognormals and gammas
	
		WHO used gammas

		Lognormals should be more challenging

----------------------------------------------------------------------

Approximating the distribution

BCC

WIDEFIG Generation_distributions/lognormal.histcomp.Rout.pdf

NCC

WIDEFIG Generation_distributions/lognormal.ga.histcomp.Rout.pdf

EC

----------------------------------------------------------------------

Approximating the curve

FIG Generation_distributions/lognormal.curve.Rout.pdf

----------------------------------------------------------------------

Linking framework

	$
		\mathrm{Epidemic~strength} (\Rx) = 
		{\mathrm{Epidemic~speed} (r) \over
		\mathrm{Generation~speed} (1/G)}
	$

		$ \Rx  = X(r\bar G; 1/\kappa)$

----------------------------------------------------------------------

Summary

	Generation intervals are the missing link between $r$ and \Rx

	We need better methods for estimating them, and propagating
	uncertainty to other parts of the model

	For many practical applications:

		Estimating the mean generation interval is not enough

		But estimating the mean and CV may be enough

	Filtered mean conclusions still apply:

		increased generation times imply larger \Rx.

----------------------------------------------------------------------

TSEC Generation intervals through time

	Generation intervals can be estimated by:

		Observing patients:
		
			How long does it take to become infectious?
		
			How long does it take to recover?

			What is the time profile of infectiousness/activity?

		Contact tracing

			Who (probably) infected whom?

			When did each become ill (serial interval)?

----------------------------------------------------------------------

Growing epidemics

BC

	Generation intervals look \emph{faster} at the beginning of an epidemic

		A disproportionate number of people are infectious right now

		They haven't finished all of their transmitting

		We are biased towards observing faster events

NC

CFIG WA_Ebola_Outbreak/liberia.npc.tsplot.Rout-3.pdf

EC

----------------------------------------------------------------------

Forward and backward intervals

FIG my_images/GI_PRSB_1.jpg

CREDIT Champredon and Dushoff, 2015. DOI:10.1098/rspb.2015.2026

----------------------------------------------------------------------

Renewal equation

	$i(t) = S(t) \int{k(\tau)i(t-\tau) \,d\tau}$

	$i_s(t) = S(t) k(t-s) i(s)$

	Backward intervals 

		Who infected the people infected at time $t$?
	
			$\propto k(t-s) i(s)$

		Depends on $k$, but also on changes in $i(s)$

	Forward intervals 

		Who did the people infected at time $s$ infect?
	
			$\propto S(t) k(t-s)$

		Depends on $k$, but also on changes in $S(t)$

----------------------------------------------------------------------

What changes backward intervals?

FIG my_images/GI_PRSB_2.jpg

----------------------------------------------------------------------

What changes forward intervals?

FIG my_images/GI_PRSB_3.jpg

----------------------------------------------------------------------

Comparison to simulations

FIG my_images/GI_PRSB_4.jpg

----------------------------------------------------------------------

Conclusion

	Backward intervals change if the number of infectious individuals is
	changing as you look back

	Forward intervals change if the number of \emph{susceptible} individuals is
	changing as you look forward

	Lack of care in defining generation intervals can lead to bias

		These biases can be corrected

----------------------------------------------------------------------

SEC Strength and Speed of Epidemics

----------------------------------------------------------------------

Strength: $\Rx$ -- the reproductive number

BCC

	Expected number of new cases per cases
	
	$\Rx = \beta D S/N$

		Disease increases iff $\Rx>1$

NCC

CFIG my_images/endemic.Rout-0.png

EC

----------------------------------------------------------------------

Speed: $r$ -- the growth rate

BCC

	$\ds i(t) \approx i(0) \exp(rt)$

	$\ds C = 1/r$

	$\ds T_2 = \ln(2)/r$

NCC

CFIG SIR_simulations/hiv_plot.Rout-0.pdf

EC

----------------------------------------------------------------------

Is \Rx\ better than $r$?

	\Rx\ predicts final size

	\Rx\ predicts long-term incidence

	\Rx\ gives a threshold for control

		and tells us how much control is necessary

----------------------------------------------------------------------

EXTRA SS HIV interventions

----------------------------------------------------------------------

Can treatment stop the HIV epidemic?

FIG web_drop/cocktail.jpg

----------------------------------------------------------------------

Are HIV generations fast or slow?

BCC

	Fast generations mean:

		Testing and treating will help less

		\emph{but} lower epidemic strength

NCC

\vspace{-0.4in}

CFIG Generation_distributions/steps.Rout-1.pdf

\vspace{-0.4in}

CFIG Generation_distributions/steps.Rout-0.pdf

EC

----------------------------------------------------------------------

Eaton and Hallett

	Predicted effectiveness of test and treat intervention minimally sensitive to proportion of early transmission

	Fast transmission:

		low proportion prevented, but low $\Rx$ estimate


	Slow transmission:

		high proportion prevented, but high $\Rx$ estimate

	CREDIT Eaton JW, Hallett TB.  Proc Natl Acad Sci U S A. 2014 Nov 11;111(45):16202-7.

----------------------------------------------------------------------

How fast do people need to be treated?

	Idealized case: 

		$k(\tau) \rightarrow$

		$\hat k(\tau) = k(\tau) \exp (-h \tau)$, where $h$ is the ``hazard"
		(instantaneous rate) of treatment

	Euler-Lotka

		$$1 = \int{\hat k(\tau)\exp(-\hat r\tau) \,d\tau}$$

		$$ = \int{k(\tau)\exp(-h\tau)\exp(-\hat r\tau) \,d\tau}$$

		$$ \hat r = r - h$$

	Required treatment hazard is equal to $r$!

----------------------------------------------------------------------

SS Intervention strength

----------------------------------------------------------------------

PSLIDE Epidemic strength

BC

FIG ss_pix/ess.Rout-0.pdf

NC

	\Rx, the epidemic strength, is the area under the curve.

EC

----------------------------------------------------------------------

Strength of intervention

BC

FIG ss_pix/ess.Rout-2.pdf

NC

	\ldots by what factor do I need to reduce this curve to eliminate the epidemic

EC

----------------------------------------------------------------------

PSLIDE Different interventions

FIG ss_pix/ess.Rout-2.pdf

----------------------------------------------------------------------

PSLIDE Different interventions

FIG ss_pix/ess.Rout-1.pdf

----------------------------------------------------------------------

Measuring intervention strength

	Imagine we have an intervention that reduces transmission

		$k(\tau) \to k(\tau)/L(\tau)$

		Define intervention \emph{strength} $\theta = \Rx/\hatR$ -- the
		proportional amount by which the intervention reduces transmission.

	We then have:

		$\ds \theta = 1/\left\langle 1/L(\tau) \right\rangle_{g(\tau)}$

		$\theta$ is \emph{the harmonic mean} of $L$, weighted by the generation
		distribution $g$.

	Outbreak can be controlled if $\theta > \Rx$

----------------------------------------------------------------------

The strength paradigm

	$k(\tau) = \Rx g(\tau)$
	
		$g$ is the intrinsic generation interval

		$\Rx$ is the strength of the epidemic

	If $L(\tau) \equiv L$, then $\theta=L$ is the strength of the intervention

	In general, $\theta$ is a (harmonic) mean of $L$

		weighted by $g(\tau)$, but not affected by \Rx.

	Epidemic is controlled if $\theta > \Rx$

----------------------------------------------------------------------

SS Intervention speed

----------------------------------------------------------------------

Epidemic speed

BC

PIC FIG ss_pix/ess.Rout-0.pdf

NC

	$r$, the epidemic speed, is the ``discount'' rate required to balance the
	tendency to grow

EC

----------------------------------------------------------------------

Epidemic speed

BC

PIC FIG ss_pix/ess.Rout-3.pdf

NC

	$k(\tau) = \exp(r\tau) b(\tau)$, where $b(\tau)$ is the initial backward
	generation interval

EC

----------------------------------------------------------------------

Speed of intervention

BC

FIG ss_pix/ess.Rout-3.pdf

NC

	\ldots how \emph{quickly} do I need to reduce this curve to eliminate the epidemic

EC

----------------------------------------------------------------------

PSLIDE Different interventions

FIG ss_pix/ess.Rout-3.pdf

----------------------------------------------------------------------

PSLIDE Different interventions

FIG ss_pix/ess.Rout-1.pdf

----------------------------------------------------------------------

Measuring intervention speed

	Define intervention \emph{speed} $\phi = r-\hat r$ -- the
	amount by which the intervention slows down spread. 

	We then have:

		$\ds 1 =
			\left\langle \frac{\exp(\phi\tau)}{L(\tau)} \right\rangle_{b(\tau)}$

	$\phi$ is \emph{sort of a mean} of the \emph{hazard} associated with $L$

		Because $L(t) = \exp(ht)$ when hazard is constant

		Averaged over the initial \emph{backwards} generation interval

	Outbreak can be controlled if $\phi > r$.

----------------------------------------------------------------------

The speed paradigm

	$k(\tau) = \exp(r\tau) b(\tau)$,
	
		$r$ is the speed of the epidemic

		$b$ is the initial backward generation interval

	If $h(\tau) \equiv h$ ($L(\tau) \equiv \exp(h\tau)$), then $\phi=h$ is the speed of the intervention

	In general, $\phi$ is a (weird) mean of $L$

		weighted by $b(\tau)$, but not (otherwise) affected by $r$.

	Epidemic is controlled if $\phi > r$

----------------------------------------------------------------------

SS HIV estimates

----------------------------------------------------------------------

Condom intervention

FIG ss_pix/hss.Rout-4.pdf

----------------------------------------------------------------------

Find and treat

FIG ss_pix/hss.Rout-5.pdf

----------------------------------------------------------------------

Low early transmission

FIG ss_pix/test.scen.Rout-0.pdf

----------------------------------------------------------------------

High early transmission

FIG ss_pix/test.scen.Rout-2.pdf

----------------------------------------------------------------------

Range of estimates

FIG ss_pix/test.scen.Rout-4.pdf

----------------------------------------------------------------------

Find and treat

FIG ss_pix/test.scen.Rout-0.pdf

----------------------------------------------------------------------

Low early transmission

FIG ss_pix/test.scen.Rout-1.pdf

----------------------------------------------------------------------

High early transmission

FIG ss_pix/test.scen.Rout-3.pdf

----------------------------------------------------------------------

Range of estimates

FIG ss_pix/test.scen.Rout-5.pdf

----------------------------------------------------------------------

Condom intervention

FIG ss_pix/flat.scen.Rout-4.pdf

----------------------------------------------------------------------

Condom intervention

FIG ss_pix/flat.scen.Rout-5.pdf

----------------------------------------------------------------------

TSS Ways of looking

FIG web_drop/lens.jpg

----------------------------------------------------------------------

Measuring the epidemic

BCC

CFIG web_drop/ew_measles.png

NCC

CFIG fitting_code/mexican_plots.Rout-0.pdf

EC

----------------------------------------------------------------------

Measuring the intervention

BCC

CFIG web_drop/vaccination.jpg

NCC

CFIG web_drop/tutu.jpg

EC

----------------------------------------------------------------------

Conclusion

	$r$ and $\Rx$ have more in common than we think

	Sometimes ``strength'' and sometimes ``speed'' can help us see epidemic
	control questions more clearly

	This perspective helps us understand why find and treat predictions are
	robust to assumptions about transmission

----------------------------------------------------------------------

Thanks

	Organizers

	Audience

	Collaborators

	Funders: NSERC, CIHR

----------------------------------------------------------------------

EXTRA SS Control example figures

----------------------------------------------------------------------


HIGHFIG ss_pix/ess.Rout-1.pdf

----------------------------------------------------------------------

HIGHFIG ss_pix/hss.Rout-0.pdf

----------------------------------------------------------------------

HIGHFIG ss_pix/hss.Rout-2.pdf

----------------------------------------------------------------------

HIGHFIG ss_pix/hss.Rout-3.pdf

----------------------------------------------------------------------

HIGHFIG ss_pix/hss.Rout-1.pdf

----------------------------------------------------------------------
